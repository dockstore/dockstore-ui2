<app-header>
  <img src="../assets/images/dockstore/dockstore-workflows-green.png"> My Workflows
  <div class="pull-right refresh-all-holder">
    <button type="button" class="refresh-all-button btn btn-primary" (click)="refreshAllWorkflows()">
      Refresh All Workflows
    </button>
  </div>
</app-header>
<div class="container padding-top">
  <div class="row" *ngIf="orgWorkflows?.length == 0">
    <div class="col-md-12">
      <div class="alert alert-info" role="alert">
        <p>
          <span class="glyphicon glyphicon-info-sign"></span>
          There are currently no workflows registered under this account, to add your first workflow, do one of the following:
        </p>
        <ul>
          <li>
            Press the 'Refresh All Workflows' button to create workflow stubs for all of your source control repositories.  Browse to the workflow stubs and refresh/publish those that correspond to real workflows.
          </li>
          <li>
            Press the 'Register Workflow' button to manually add a workflow.
          </li>
        </ul>
      </div>
    </div>
  </div>
  <!--Tool Content Page-->
  <div class="row">
    <div class="col-md-3 containers-rsb">
      <accordion [closeOthers]="oneAtATime">
        <accordion-group *ngFor="let orgObj of orgWorkflows" panelClass="containers-accordion" [heading]="orgObj?.organization" [isOpen]="orgObj?.isFirstOpen">
          <div *ngFor="let workflowObj of orgObj?.workflows">
            <div class="panel-container-label" [ngClass]="{selected: workflow.id === workflowObj.id}">
              <div class="container-name-oflw pull-left" title="{{workflowObj?.repository + (workflowObj?.workflowName ? ' (' + workflowObj?.workflowName + ')' : '')}}">
                <a style="cursor: pointer;" (click)="selectWorkflow(workflowObj)">
                  {{workflowObj?.repository + (workflowObj?.workflowName ? ' (' + workflowObj?.workflowName + ')' : '')}}
                </a>
              </div>
              <div class="pull-right">
                <span class="label" [ngClass]="workflowObj?.is_published ? 'label-primary' : 'label-warning'">
                  {{ workflowObj?.is_published ? 'PUB' : 'UNPUB'}}
                </span>
              </div>
            </div>
          </div>
          <app-refresh-workflow-organization class="pull-right" [organization]="orgObj?.organization"></app-refresh-workflow-organization>
          <button type="button" class="glyphicon glyphicon-plus btn btn-primary btn-xs pull-right add-container-ns" (click)="setModalGitURL(orgObj?.organization + '/new_workflow'); showModal()">
          </button>
        </accordion-group>
      </accordion>
      <div>
        <button type="button" class="btn btn-primary btn-sm pull-right" (click)="showModal()">Register Workflow</button>
      </div>
      <app-register-workflow-modal></app-register-workflow-modal>
    </div>
    <div *ngIf="workflow" class="col-md-9 containers-rsb">
      <app-workflow [isWorkflowPublic]="false"></app-workflow>
    </div>
  </div>
</div>
