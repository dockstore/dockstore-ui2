<div
  *ngIf="
    workflow?.descriptorType === 'WDL' ||
    workflow?.descriptorType === 'CWL' ||
    workflow.descriptorType === 'NFL' ||
    workflow.descriptorType === 'gxformat2'
  "
  class="panel panel-default"
>
  <div class="panel-heading">
    <h3>Launch with</h3>
  </div>
  <div class="p-3 panel-body">
    <div class="container-source-repos">
      <div class="container-launch-with">
        <div fxLayout="row wrap">
          <div fxFlex="100%" *ngIf="workflow?.descriptorType === 'WDL'">
            <div *ngIf="(hasFileImports$ | async) || (hasHttpImports$ | async)" class="import-warning">
              Warning: this version of the WDL has imports, which are not supported by DNAstack. Make sure to select a version without
              imports in DNAstack.
            </div>
            <a
              mat-raised-button
              [matTooltip]="!(hasContent$ | async) ? 'The WDL has no content.' : ''"
              target="_blank"
              rel="noopener"
              [attr.href]="config.DNASTACK_IMPORT_URL + '?descriptorType=wdl&path=' + workflowPathAsQueryValue"
              [disabled]="!(hasContent$ | async)"
              color="primary"
              ><img data-cy="dnastackIcon" src="../assets/images/thirdparty/dnastack.png" /> DNAstack &raquo;</a
            >
          </div>
          <div fxFlex="100%" *ngIf="workflow?.descriptorType === 'WDL'">
            <a
              mat-raised-button
              [matTooltip]="!(hasContent$ | async) ? 'The WDL has no content.' : ''"
              target="_blank"
              rel="noopener"
              [attr.href]="config.DNANEXUS_IMPORT_URL + '?source=' + trsUrl"
              [disabled]="!(hasContent$ | async)"
              color="primary"
              ><mat-icon svgIcon="dnanexus" data-cy="dnanexusIcon"></mat-icon> DNAnexus &raquo;</a
            >
          </div>
          <div fxFlex="100%" *ngIf="workflow?.descriptorType === 'WDL'">
            <a
              mat-raised-button
              [matTooltip]="terraTooltip$ | async"
              target="_blank"
              rel="noopener"
              [disabled]="disableTerraPlatform$ | async"
              [attr.href]="config.TERRA_IMPORT_URL + '/' + workflow?.full_workflow_path + ':' + selectedVersion?.name"
              color="primary"
              ><mat-icon svgIcon="terra" data-cy="terraIcon"></mat-icon> Terra &raquo;</a
            >
          </div>
          <div fxFlex="100%" *ngIf="workflow?.descriptorType === 'CWL'">
            <a
              mat-raised-button
              [matTooltip]="cgcTooltip$ | async"
              target="_blank"
              rel="noopener"
              [attr.href]="config.CGC_IMPORT_URL + '?trs=' + trsUrl"
              [disabled]="disableSevenBridgesPlatform$ | async"
              color="primary"
              ><img src="../assets/images/thirdparty/cgc.png" /> CGC
            </a>
          </div>
          <div fxFlex="100%" *ngIf="workflow?.descriptorType === 'CWL'">
            <a
              mat-raised-button
              [matTooltip]="bdCatalystSevenBridgesTooltip$ | async"
              target="_blank"
              rel="noopener"
              [attr.href]="config.BD_CATALYST_SEVEN_BRIDGES_IMPORT_URL + '?trs=' + trsUrl"
              [disabled]="disableSevenBridgesPlatform$ | async"
              color="primary"
              >NHLBI BioData Catalyst
            </a>
          </div>
          <div fxFlex="100%" *ngIf="workflow?.descriptorType === 'WDL'">
            <a
              mat-raised-button
              [matTooltip]="anvilTooltip$ | async"
              target="_blank"
              rel="noopener"
              [disabled]="disableTerraPlatform$ | async"
              [attr.href]="config.ANVIL_IMPORT_URL + '/' + workflow?.full_workflow_path + ':' + selectedVersion?.name"
              color="primary"
              ><mat-icon class="anvil-icon" svgIcon="anvil" data-cy="anvilIcon"></mat-icon> AnVIL &raquo;</a
            >
          </div>
          <div fxFlex="100%" *ngIf="workflow?.descriptorType === 'WDL'">
            <a
              mat-raised-button
              [matTooltip]="bdCatalystTerraTooltip$ | async"
              target="_blank"
              rel="noopener"
              [disabled]="disableTerraPlatform$ | async"
              [attr.href]="config.BD_CATALYST_TERRA_IMPORT_URL + '/' + workflow?.full_workflow_path + ':' + selectedVersion?.name"
              color="primary"
              data-cy="nhlbiWdlButton"
              >NHLBI BioData Catalyst</a
            >
          </div>
          <div fxFlex="100%" *ngIf="workflow?.descriptorType === 'CWL'">
            <a
              mat-raised-button
              [matTooltip]="cavaticaTooltip$ | async"
              target="_blank"
              rel="noopener"
              [attr.href]="config.CAVATICA_IMPORT_URL + '?trs=' + trsUrl"
              [disabled]="disableSevenBridgesPlatform$ | async"
              color="primary"
              ><img src="../assets/images/thirdparty/cavatica.png" /> Cavatica
            </a>
          </div>

          <div fxFlex="100%" *ngIf="workflow?.descriptorType === 'gxformat2'">
            <a
              mat-raised-button
              [matTooltip]="!(hasContent$ | async) ? 'The Galaxy has no content.' : 'Export this workflow to Galaxy instance'"
              target="_blank"
              rel="noopener"
              [attr.href]="config.GALAXY_INSTANCE_IMPORT_URL + '%23workflow/' + workflow?.full_workflow_path"
              color="primary"
              ><img src="../assets/images/thirdparty/cavatica.png" /> Galaxy
            </a>
          </div>

          <!--          <div fxFlex="100%">-->
          <!--            <button mat-raised-button [matMenuTriggerFor]="menu"> Galaxy </button>-->
          <!--            <mat-menu #menu="matMenu" xPosition="before" yPosition="above">-->
          <!--              Please choose a well-known server to launch on, or specify your own.-->
          <!--              <mat-radio-group fxLayout="column" name="launchWithUrl" [(ngModel)]="launchWithOption" (click)="$event.stopPropagation();">-->
          <!--                <mat-radio-button name="launchWithUrl" value="https://UseGalaxy.org/workflows/trs_import?trs_server=dockstore.org&trs_id="> UseGalaxy.org (Main) </mat-radio-button>-->
          <!--                <mat-radio-button name="launchWithUrl" value="https://UseGalaxy.eu/workflows/trs_import?trs_server=dockstore.org&trs_id="> UseGalaxy.eu </mat-radio-button>-->
          <!--                <mat-radio-button name="launchWithUrl" value="https://UseGalaxy.org.au/workflows/trs_import?trs_server=dockstore.org&trs_id="> UseGalaxy.org.au </mat-radio-button>-->
          <!--                <mat-form-field>-->
          <!--                  <input matInput placeholder="Specify a url..." [(ngModel)]="_customLaunchWithOption" (ngModelChange)="launchWithOption = 'other'" name="something">-->
          <!--                </mat-form-field>-->
          <!--              </mat-radio-group>-->
          <!--              Launch {{launchWith.url}}-->
          <!--              <button mat-button (click)="closeMatMenu()">Cancel</button>-->
          <!--              <a-->
          <!--                mat-raised-button-->
          <!--                [matTooltip]="!(hasContent$ | async) ? 'The Galaxy has no content.' : 'Export this workflow to Galaxy instance'"-->
          <!--                target="_blank"-->
          <!--                rel="noopener"-->
          <!--                [attr.href]="launchWith.url + '%23workflow/' + workflow?.full_workflow_path"-->
          <!--                color="secondary"-->
          <!--                (click) = selectDefault()-->
          <!--              ><img src="../assets/images/thirdparty/cavatica.png" /> Launch-->
          <!--              </a>-->
          <!--              Galaxy Default {{galaxyDefault}}-->
          <!--            </mat-menu>-->
          <!--          </div>-->

          <div fxFlex="100%" *ngIf="workflow?.descriptorType === 'gxformat2'">
            <button mat-raised-button [matMenuTriggerFor]="menu">Galaxy</button>
            <mat-menu #menu="matMenu" xPosition="before" yPosition="below">
              Please choose a well-known server to launch on, or specify your own.
              <mat-radio-group fxLayout="column" name="launchWithUrl" [(ngModel)]="launchWithOption" (click)="$event.stopPropagation()">
                <mat-radio-button
                  *ngFor="let galaxyInstance of cloudInstances | filterCloudInstances: 'GALAXY'"
                  name="launchWithUrl"
                  value="{{ galaxyInstance.url }}"
                  [checked]="this.galaxyDefault === galaxyInstance.url"
                >
                  {{ galaxyInstance.displayName }}
                </mat-radio-button>
                <ng-container *ngIf="user">
                  <mat-radio-button
                    *ngFor="let usersGalaxyInstance of usersCloudInstances | filterCloudInstances: 'GALAXY'"
                    name="launchWithUrl"
                    value="{{ usersGalaxyInstance.url }}"
                    [checked]="this.galaxyDefault === usersGalaxyInstance.url"
                  >
                    {{ usersGalaxyInstance.displayName }} (Custom)
                  </mat-radio-button>
                  <mat-radio-button value="other">
                    <mat-form-field>
                      <input
                        matInput
                        placeholder="Specify a url..."
                        [(ngModel)]="customLaunchWithOption"
                        (ngModelChange)="launchWithOption = 'other'"
                        name="something"
                      />
                    </mat-form-field>
                  </mat-radio-button>
                </ng-container>
              </mat-radio-group>
              <button mat-button (click)="closeMatMenu()">Cancel</button>
              <a
                mat-raised-button
                [matTooltip]="!(hasContent$ | async) ? 'The Galaxy has no content.' : 'Export this workflow to Galaxy instance'"
                target="_blank"
                rel="noopener"
                [attr.href]="launchWith.url + '%23workflow/' + workflow?.full_workflow_path"
                color="secondary"
                (click)="selectDefault()"
                ><img src="../assets/images/thirdparty/cavatica.png" /> Launch
              </a>
              {{ launchWith.url }}
            </mat-menu>
          </div>

          <div fxFlex="100%" *ngIf="workflow?.descriptorType === 'NFL'">
            <a
              mat-raised-button
              [matTooltip]="!(hasContent$ | async) ? 'The Nextflow has no content.' : 'Export this workflow to Nextflow Tower'"
              target="_blank"
              rel="noopener"
              [attr.href]="
                config.NEXTFLOW_TOWER_IMPORT_URL +
                '?pipeline=https://' +
                workflow.sourceControl +
                '/' +
                workflow.organization +
                '/' +
                workflow.repository +
                '&revision=' +
                selectedVersion.name
              "
              [disabled]="!(hasContent$ | async)"
              color="primary"
            >
              <img src="../assets/images/thirdparty/nextflow-icon.png" alt="Nextflow icon" /> Nextflow Tower
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
