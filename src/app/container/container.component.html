<div class="container">
  <div class="row">
    <h3>
      <span id="verifiedIcon" *ngIf="tool?.versionVerified">
        <a href={{tool?.verifiedLinks}}>
          <span class="glyphicon glyphicon-ok" tooltip="Verified"></span>
        </a>
      </span>
      {{ title }}
    </h3>
    <div *ngIf="tool">
      <span class="label label-default container-label" *ngFor="let label of labels">
        {{label}}
      </span>
    </div>
    <p class="update">
      Last build: {{ tool?.agoMessage || 'n/a' }}
    </p>
    <div class="row">
      <div class="ds-tabs col-sm-12 col-md-10 col-lg-10">
        <tabset id="tool_tabs" justified="true">
          <tab id="infoTab" heading="Info" id="infoTab">
            <div>
              <ul class="list-unstyled container-info" *ngIf="tool">
                <li>
                  <strong tooltip="Author listed in descriptor">Author</strong>:
                  {{ tool?.author || 'n/a' }}
                </li>
                <li>
                  <strong tooltip="E-mail of corresponding author for tool">E-mail</strong>:
                  <span *ngIf="!tool?.email">n/a</span>
                  <a *ngIf="tool?.email" href="mailto:{{tool?.email}}">
                    {{ tool?.email }}
                  </a>
                </li>
                <li>
                  <strong tooltip="Git repository for the associated tool descriptors and Dockerfile">GitHub</strong>:
                  <a [href]="tool?.providerUrl">
                    {{ tool?.providerUrl }}
                  </a>
                </li>
                <li>
                  <strong tooltip="Docker registry for the associated Docker images">Quay.io</strong>:
                  <a [href]="tool?.imgProviderUrl">
                    {{ tool?.imgProviderUrl }}
                  </a>
                </li>
                <li>
                  <strong tooltip="Path in Git repository to the tool's Dockerfile">Dockerfile Path</strong>:
                  {{ tool?.default_dockerfile_path }}
                </li>
                <li>
                  <strong tooltip="Path in Git repository to main CWL descriptor file">CWL Path</strong>:
                  {{ tool?.default_cwl_path || 'n/a' }}
                </li>

                <li>
                  <strong tooltip="Path in Git repository to main WDL descriptor file">WDL Path</strong>:
                  {{ tool?.default_wdl_path || 'n/a' }}
                </li>
                <li>
                  <strong tooltip="{{tool?.buildModeTooltip}}">Build Mode</strong>:
                  {{ tool?.buildMode }}
                </li>
                <li>
                  <strong tooltip="Date and time of the last build of the Docker image">Last Build</strong>:
                  {{ tool?.lastBuildDate }}
                </li>
                <li>
                  <strong tooltip="Date and time of the last update to the Tool entry">Last Updated</strong>:
                  {{ tool?.lastUpdatedDate }}
                </li>
              </ul>
            </div>
            <div *ngIf="tool">
              <label tooltip="Description of tool obtained from tool descriptor">
                Description
              </label>
              <div class="well well-sm">
                <pre>{{ tool?.description || 'No description associated with this container.' }}</pre>
              </div>
              <div *ngIf="validVersions">
                <app-launch [versions]="validVersions" [default]="defaultVersion" [path]="tool?.path"></app-launch>
              </div>
            </div>
          </tab>
          <tab id="labelsTab" heading="Labels" *ngIf="tool">
            <button type="sbutton"
                    *ngIf="!labelsEditMode"
                    class="btn btn-link pull-right"
                    (click)="toggleLabelsEditMode()">
              <span class="glyphicon glyphicon-edit"></span>Edit
            </button>
            <ul class="list-unstyled container-info" *ngIf="!labelsEditMode">
              <li *ngIf="tool">
                <strong>Labels:</strong>
                <span *ngIf="tool?.labels.length === 0">n/a</span>
                <span class="label label-default container-label" *ngFor="let label of labels">
               {{label}}
              </span>
              </li>
            </ul>
            <form name="editContainerForm"
                  class="edit-container form-inline"
                  (ngSubmit)="submitContainerEdits()"
                  #labelForm="ngForm"
                  novalidate>
              <button type="submit"
                      class="btn btn-link pull-right"
                      [disabled]="!labelForm.form.valid"
                      *ngIf="labelsEditMode">
                <span class="glyphicon glyphicon-floppy-save"></span>Save
              </button>
              <div *ngIf="labelsEditMode">
                <div class="form-group">
                  <label>Tool Labels:</label>
                  <input
                    id="toolLabels"
                    type="text"
                    class="input-sm form-control"
                    name="toolLabels"
                    [(ngModel)]="containerEditData.labels"
                    #name="ngModel"
                    maxlength="512"
                    [pattern]="labelPattern"
                    placeholder="e.g. dockstore, oicr-icgc, pancancer"/>
                </div>
                <div *ngIf="name.errors && (name.dirty || name.touched)" class="alert alert-danger">
                  <div [hidden]="!name.errors.maxlength">
                    Labels string is too long. (Max 512 characters.)
                  </div>
                  <div [hidden]="!name.errors.pattern">
                    Labels are comma-delimited, and may only contain alphanumerical characters and internal hyphens.
                  </div>
                </div>
              </div>
            </form>
          </tab>
          <tab heading="Versions" *ngIf="validVersions">
            <app-versions-container [versions]="tool?.tags" id="versionsTab"
                                    [verifiedSource]="tool?.verifiedSources">
            </app-versions-container>
          </tab>
          <tab heading="Files" *ngIf="validVersions">
            <app-files-container [id]="tool?.id" [versions]="validVersions"
                                 [default]="defaultVersion">
            </app-files-container>
          </tab>
        </tabset>
      </div>
    </div>

    <div class="col-sm-12 col-md-2 col-lg-2">
      <div class="panel panel-default" *ngIf="tool?.versionVerified">
        <div class="panel-heading">
          <strong>Verified</strong>
        </div>
        <div class="panel-body">
          <tbody>
          <tr *ngFor="let source of tool?.verifiedSources">
            <td>{{source}}</td>
          </tr>
          </tbody>
        </div>
      </div>
    </div>

  </div>
</div>
